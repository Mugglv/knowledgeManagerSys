(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dc4fac4c"],{1276:function(e,t,i){"use strict";var a=i("d784"),o=i("44e7"),r=i("825a"),s=i("1d80"),n=i("4840"),l=i("8aa5"),d=i("50c4"),c=i("14c3"),u=i("9263"),v=i("d039"),h=[].push,p=Math.min,g=4294967295,m=!v((function(){return!RegExp(g,"y")}));a("split",2,(function(e,t,i){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,i){var a=String(s(this)),r=void 0===i?g:i>>>0;if(0===r)return[];if(void 0===e)return[a];if(!o(e))return t.call(a,e,r);var n,l,d,c=[],v=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),p=0,m=new RegExp(e.source,v+"g");while(n=u.call(m,a)){if(l=m.lastIndex,l>p&&(c.push(a.slice(p,n.index)),n.length>1&&n.index<a.length&&h.apply(c,n.slice(1)),d=n[0].length,p=l,c.length>=r))break;m.lastIndex===n.index&&m.lastIndex++}return p===a.length?!d&&m.test("")||c.push(""):c.push(a.slice(p)),c.length>r?c.slice(0,r):c}:"0".split(void 0,0).length?function(e,i){return void 0===e&&0===i?[]:t.call(this,e,i)}:t,[function(t,i){var o=s(this),r=void 0==t?void 0:t[e];return void 0!==r?r.call(t,o,i):a.call(String(o),t,i)},function(e,o){var s=i(a,e,this,o,a!==t);if(s.done)return s.value;var u=r(e),v=String(this),h=n(u,RegExp),f=u.unicode,b=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(m?"y":"g"),y=new h(m?u:"^(?:"+u.source+")",b),w=void 0===o?g:o>>>0;if(0===w)return[];if(0===v.length)return null===c(y,v)?[v]:[];var x=0,k=0,D=[];while(k<v.length){y.lastIndex=m?k:0;var O,S=c(y,m?v:v.slice(k));if(null===S||(O=p(d(y.lastIndex+(m?0:k)),v.length))===x)k=l(v,k,f);else{if(D.push(v.slice(x,k)),D.length===w)return D;for(var j=1;j<=S.length-1;j++)if(D.push(S[j]),D.length===w)return D;k=x=O}}return D.push(v.slice(x)),D}]}),!m)},3128:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-card",{staticClass:"video-add-or-update"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("h3",[e._v(e._s(e.isUpdate?"修改":"发布")+"视频")])]),i("el-form",{ref:"videoData-form",attrs:{model:e.videoData,rules:e.rules,"label-width":"150px"}},[i("el-form-item",{attrs:{label:"视频名称",prop:"videoTitle"}},[i("el-input",{attrs:{placeholder:"请输入视频名称"},model:{value:e.videoData.videoTitle,callback:function(t){e.$set(e.videoData,"videoTitle",t)},expression:"videoData.videoTitle"}})],1),i("el-form-item",{attrs:{label:"视频资源文件"}},[i("el-upload",{staticClass:"upload",attrs:{action:e.uploadAction,headers:e.headers,accept:"video/mp4, video/x-msvideo, video/3gpp, application/x-mpegURL, video/x-ms-wmv","on-remove":e.handleRemoveVideo,"before-remove":e.beforeRemove,limit:1,"on-success":e.handleVideoSuccess,"on-exceed":e.handleExceed,"file-list":e.videoFileList,"before-upload":e.beforeVideoUpload,"on-error":e.handleLogoError}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传视频，且不超过1GB ")])],1)],1),i("el-form-item",{attrs:{label:"视频封面图"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{"list-type":"picture-card",action:e.uploadAction,headers:e.headers,accept:"image/jpeg, image/png","file-list":e.imgShowList,"on-exceed":e.handleExceed,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"on-success":e.handleImageSuccess,"before-upload":e.beforeImageUpload,"on-error":e.handleLogoError,limit:1}},[i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),i("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),i("el-form-item",{attrs:{label:"视频描述",prop:"videoDes"}},[i("el-input",{attrs:{rows:6,type:"textarea",placeholder:"请输入视频描述"},model:{value:e.videoData.videoDes,callback:function(t){e.$set(e.videoData,"videoDes",t)},expression:"videoData.videoDes"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",disabled:e.unSubmit},on:{click:function(t){return e.submitAreaForm("videoData-form")}}},[e._v(e._s(e.isUpdate?"修改视频信息":"新增视频"))]),i("el-button",{on:{click:function(t){return e.resetForm("videoData-form")}}},[e._v("重 置")])],1)],1)],1)},o=[],r=(i("a4d3"),i("4de4"),i("4160"),i("b0c0"),i("e439"),i("dbb4"),i("b64b"),i("ac1f"),i("1276"),i("159b"),i("ade3")),s=i("d4ec"),n=i("bee2"),l=i("99de"),d=i("7e84"),c=i("262e"),u=i("9ab4"),v=i("60a3"),h=i("0f84"),p=i("9304");function g(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function m(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?g(Object(i),!0).forEach((function(t){Object(r["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var f=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(l["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.isUpdate=!1,e.videoData={videoTitle:"",videoUrl:"",videoImage:"",videoDes:""},e.rules={videoTitle:[{required:!0,message:"视频名称不能为空",trigger:"blur"}],videoDes:[{required:!0,message:"视频描述不能为空",trigger:"blur"}]},e.headers={},e.uploadAction="",e.unSubmit=!1,e.dialogImageUrl="",e.dialogVisible=!1,e.imgShowList=[],e.videoFileList=[],e}return Object(c["a"])(t,e),Object(n["a"])(t,[{key:"handleImageSuccess",value:function(e,t){this.$message.success("文件上传成功,已保存。"),this.imgShowList.push({name:e.data,url:e.data}),this.loading.close(),this.videoData.videoImage=e.data.split("?")[0]}},{key:"handleLogoError",value:function(){this.loading.close(),this.$message.error("文件上传失败，请重新上传！")}},{key:"beforeImageUpload",value:function(e){var t=e.size/1024/1024<5;return t||this.$message.error("上传的图片大小不能超过 5MB!"),t&&this.startLoading(),t}},{key:"handleRemove",value:function(e){this.imgShowList=this.imgShowList.filter((function(t){return t.url!==e.url}))}},{key:"handlePictureCardPreview",value:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0}},{key:"handleRemoveVideo",value:function(e){this.videoFileList=this.videoFileList.filter((function(t){return t.url!==e.url}))}},{key:"beforeVideoUpload",value:function(e){var t=e.size/1024/1024<1024;return t||this.$message.error("上传的视频文件大小不能超过 1GB!"),t&&this.startLoading(),t}},{key:"startLoading",value:function(){this.loading=this.$loading({lock:!0,text:"上传中，请稍等......",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.8)"})}},{key:"handleVideoSuccess",value:function(e,t){this.$message.success("视频已经上传成功,已保存。"),this.loading.close(),this.videoFileList.push({name:t.name,url:e.data}),this.videoData.videoUrl=e.data.split("?")[0]}},{key:"handleExceed",value:function(e,t){this.$message.warning("当前限制只能上传 1 个文件")}},{key:"beforeRemove",value:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))}},{key:"created",value:function(){var e=this,t=localStorage.getItem("adminToken");t&&(this.headers["Authorization"]=t),this.uploadAction="".concat("/knowledge","/video/upload");var i=this.$route.params.videoId;i&&(this.isUpdate=!0,this.axios.get("/video?videoId=".concat(i)).then((function(t){if(200!==t.code)throw new Error(t.message);e.videoData=m({},t.data);var i=t.data.videoImage;e.imgShowList.push({name:i,url:i});var a=t.data.videoUrl;e.videoFileList.push({name:a.split("/").pop(),url:a})})).catch(this.catchErrMsg))}},{key:"submitAreaForm",value:function(e){var t=this;this.$refs[e].validate((function(e){return!!e&&(t.videoData.videoUrl?t.videoData.videoImage?(t.unSubmit=!0,void t.axios[t.isUpdate?"put":"post"](t.isUpdate?"/video/update":"/video/add",m({},t.videoData)).then((function(e){t.$message.success(e.message),t.$router.go(-1),t.unSubmit=!1})).catch((function(e){t.catchErrMsg(e),t.unSubmit=!1}))):(t.$message.error("视频封面图不能为空！！！"),!1):(t.$message.error("视频资源文件不能为空！！！"),!1))}))}}]),t}(v["e"]);f=u["a"]([Object(v["a"])({mixins:[h["a"],p["a"]]})],f);var b=f,y=b,w=(i("f4f9"),i("2877")),x=Object(w["a"])(y,a,o,!1,null,"e223a124",null);t["default"]=x.exports},f4f9:function(e,t,i){"use strict";var a=i("f9c1"),o=i.n(a);o.a},f9c1:function(e,t,i){}}]);